<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="Scrollama: Sticky Overlay Example">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel='stylesheet' href='./style.css'>
	<style>
		@font-face {
    		font-family: Helvetica;
    		src: url(./Helvetica.ttf);
		}
		#scrolly {
			position: relative;
			background-color: rgb(239,239,239);
			padding: 1rem;
		}
		#ninelines {
			margin: 0;
		    position: absolute;
		    transform: translate(-50%, -50%);
		    width:7%;
		    top:68%;
		    left:67%;
		}

		article {
			position: relative;
			padding: 0;
			max-width: 100%;
			
		}

		figure {
			position: -webkit-sticky;
			position: sticky;
			left: 0;
			width: 100%;
			margin: 0;
			-webkit-transform: translate3d(0, 0, 0);
			-moz-transform: translate3d(0, 0, 0);
			transform: translate3d(0, 0, 0);
			background-color: rgb(239,239,239);
			z-index:1;
		}

		figure p {
			text-align: center;
			padding: 1rem;
			position: relative;
			top: 50%;
			left: 50%;
			-moz-transform: translate(-50%, -50%);
			-webkit-transform: translate(-50%, -50%);
			transform: translate(-50%, -50%);

		}
		iframe{
			width:100%;
			height:100%;
			position:absolute;
			left:0px;
			top: 0px;
		}


		.step {
			/*margin: 0 auto 0 auto; 两个框之间距离*/
			position: relative;
			z-index:500;
			
		}
		.step p{
			font-size: 16px;
			color: (21,21,21);
			font-family: Helvetica;
			background: rgba(255,255,255,0.9);
			margin:5% 10%;
			padding: 5% 5% 5% 5%;
			z-index:10;

		}
		.step.is-active p {
			z-index:10;
		}
		.step span{
			font-weight: bold;
		}
		.step:last-child {
			margin-bottom: 0;
		}
		.clearfix:after{
			content: '';
			display: block;
			clear: both;
		}
		.fl{
			float: left;
		}
		.point{
			margin:5px;
			width: 5px;
			height: 5px;
			border-radius: 17px;
			background-color:rgba(255,56,77); 
		}
		.step span{
			font-weight: bold;
			color:rgb(255,56,77);
		}
	</style>

</head>

<body>
	
	<main>

		<section id='scrolly'>

			<figure>
				

				<div>
					<img id='ninelines' src='./img/9lines.png' style="z-index:0">
 					<iframe id ='CGTN' src='./CGTN/CGTN.html#slide-0' frameborder='0' scrolling='no' style='z-index:2;'>
					</iframe>
				</div>
				
				
			</figure>

			<article>
				<div class='step' data-step='1'>
				</div>

				<div class='step' data-step='2' style=''>
					<p>They have witnessed how China becomes increasingly integrated to the world and promoted the rational, orderly and coordinated development of international immigration in China. They also are valuable experience and wisdom of China’s involvement in the global governance of immigration.</p>
				</div>

				<div id='titlef' class='step' data-step='3'>
					<p style="background: url(./img/title.png);background-size:100% 100%;font-weight:bold;text-align: center;margin: 5% 15% ">3 stages and 6 categories</p>
				</div>

				<div class='step' data-step='4' style='margin-bottom: 20%'>
					<p style="font-weight:bold"><span class="point fl clearfix"></span><span style="font-weight:bold;color:rgb(255,56,77)">1949-1978: </span>Searching far and wide: from self-isolation to opening up</p>
				</div>

				<div class='step' data-step='5' style='margin-bottom: 20%'>
					<p style="font-weight:bold"><span class="point fl clearfix"></span><span style="font-weight:bold;color:rgb(255,56,77)">1978-2012: </span>The winds of change: the policy of opening up dominated by introduction at different levels</p>
				</div>

				<div class='step' data-step='6' style='margin-bottom: 20%'>
					<p style="font-weight:bold"><span class="point fl clearfix"></span><span style="font-weight:bold;color:rgb(255,56,77)">2013-2019: </span>Riding the wind and waves and setting sail: transition from scale-focused development to content-based construction and mutual learning among civilisations to provide world governance with Chinese solutions.</p>
				</div>

				<div id='titlef2' class='step' data-step='7'>
					<p style="background:rgba(255,255,255,0);"></p>
				</div>

				<div class='step' data-step='8' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">I. Open locations and ports of entry</p>
				</div>

				<div class='step' data-step='9' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">II. Immigration and entry-exit management</p>
				</div>

				<div class='step' data-step='10' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">III. Foreign business and investment</p>
				</div>

				<div class='step' data-step='11' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">IV. Marriage and family life</p>
				</div>

				<div class='step' data-step='12' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">V.Cultural exchange</p>
				</div>

				<div class='step' data-step='13' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">VI. Reward and punishment</p>
				</div>

				<div id='titlef3' class='step' data-step='14'>
					<p style="background: url(./img/title.png);background-size:100% 100%;font-weight:bold;text-align: center">Check out when your hometown opened up to the foreigners</p>
				</div>

				<div class='step' data-step='15' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">1964  First article of PD on immigration.
					</p>
				</div>

				<div class='step' data-step='16' style='margin-bottom: 25%;'>
					<p style="font-weight: bold">1982  29 cities were first opened up to foreigners. 
					</p>
				</div>

				<div class='step' data-step='17' style='margin-bottom: 25%;'>
					<p>2005  The Regulations of the P.R.C on the Administration of the En.&Ex. of Foreigners was passed.</p>
				</div>

				<div class='step' data-step='18' style='margin-bottom: 25%;'>
					<p>2012  92％ of the Chinese counties and cities allow foreign visitors.</p>
				</div>

				<div class='step' data-step='19' style='margin-bottom: 25%;'>
					<p>2013  The En.&Ex. Administration Law of the P.R.C.</p>
				</div>

				<div id='titlef4' class='step' data-step='20'>
					<p style="background: url(./img/title.png);background-size:100% 100%;font-weight:bold;text-align: center;margin:5% 0%">Immigration and entry-exit management<br>inbound tourism</p>
				</div>

				<div class='step' data-step='21' style='margin-bottom: 25%;'>
					<p style="font-weight: bold;">1978  Over 100,000 foreign tourists visited China.</p>
				</div>

				<div class='step' data-step='22' style='margin-bottom: 25%;'>
					<p style="font-weight: bold;">1985  The opening up of the Tibetan Plateau saw foreigner climbers and explorers flocking to the area.</p>
				</div>

				<div class='step' data-step='23' style='margin-bottom: 25%;'>
					<p style="font-weight: bold;">1994  Foreigners holding a valid visa or residence document may visit Shennongjia National Nature Reserve without applying for a travel document. Procedures for foreign groups in Hong Kong wishing to visit Shenzhen were simplified, and the groups could stay for 72 hours.</p>
				</div>

				<div class='step' data-step='24' style='margin-bottom: 25%;'>
					<p style="font-weight: bold;">2017  In China received over 139.48 million tourists, allowing it to maintain its place as the fourth major tourist country of the world.</p>
				</div>

				<div id='titlef5' class='step' data-step='25'>
					<p style="font-weight: bold;">2018 MPS announced at a press conference that following the State Council’s approval, the number of countries whose tour groups may visit Hainan Province without a visa has been raised from 26 to 59 from 1 May 2018, and foreigners may visit visa-free for up to 30 days, as the visa-free policy is extended from groups to individuals. The policy is to date the most practical and open in China.</p>
				</div>

				<div class='step' data-step='26' style='margin-bottom: 40%;'>
					<p style="font-weight: bold;">2019 A 144-hour visa-free transit was launched in Beijing, Tianjin, Hebei Province and the Yangtze River Delta, and over 1.8 million visitors took advantage of the policy.</p>
				</div>

				<div id='titlef6' class='step' data-step='27' style='margin-bottom: 40%;'>
					<p style="font-weight: bold;">20年间，来华旅游的外国人以男性居多，女性入境人数占比逐年增加</p>
				</div>

				<div class='step' data-step='28' style='margin-bottom: 40%;'>
					<p style="font-weight: bold;">来华外国人中以25-44岁中青年为主</p>
				</div>

				<div id='titlef7' class='step' data-step='29' style='margin-bottom: 40%;'>
					<p style="font-weight: bold;">观光休闲是外国人来华的主要目的，同时因其他目的来华的人数比例逐年增加。</p>
				</div>

				<div class='step' data-step='30' style='margin-bottom: 40%;'>
					<p style="font-weight: bold;">外国人入境人数20年间共出现四次负增长，总体呈稳定上升趋势。</p>
				</div>

				<div id='titlef8' class='step' data-step='31' style='margin-bottom: 40%;'>
					<p style="font-weight: bold;">1999 - 2018年中国入境旅游人数</p>
				</div>

				<div class='step' data-step='32' style='margin-bottom: 40%;'>
					<p style="font-weight: bold;">国内/国际旅游外汇业务收入（亿元）</p>
				</div>



				<div id='titlef9' class='step' data-step='33'>
					<p style="background: url(./img/title.png);background-size:100% 100%;font-weight:bold;text-align: center;margin: 5% 15%">Production, business<br>and investment</p>
				</div>

				<div id='titlef10' class='step' data-step='34'>
					<p>Three laws on foreign investment were introduced since 1979, which offered preferential taxes and simplified the application for business permits. Foreign investment broke the deadlock and began to grow steadily, however,  concentrated primarily in China’s east-coast area and in small and medium-sized enterprises that were labour intensive and involved in manufacturing.
					</p>
				</div>

				<div class='step' data-step='35' style='margin-bottom: 25%;'>
					<p>进口商品贸易是外商投资企业业务中重要的一环，该图表为进口商品贸易方式企业性质总值表，可以看出在进口商品贸易业务中，外资投资企业占比最高，但进步在逐年变缓。
					</p>
				</div>

				<div id='titlef11' class='step' data-step='36'>
					<p>Foreign investors: <br>
					The big data of P.D. coverage of the investment and business sector, which accounts for 45.8% is a major index that reflects the in-depth participation of foreigners in China’s economic development。
					</p>
				</div>

				<div class='step' data-step='37' style='margin-bottom: 25%;'>
					<p>该图表为近年中国吸收外商直接投资金额，可以看出外商投资逐渐增加，在我国社会经济发展中占有重要地位。
					</p>
				</div>

				<div id='titlef12' class='step' data-step='38'>
					<p style="background: url(./img/title.png);background-size:100% 100%;font-weight:bold;text-align: center;margin: 5% 15%">Marriage and family life</p>
				</div>

				<div class='step' data-step='39' style='margin-bottom: 25%;'>
					<p>Policies and regulations concerning foreigners’ marriage and family life in China accounted for 10.1% of the big data of media coverage over 70 years, and included marriage registration, adoption, inheritance, medical and health services, religion, entertainment, individual income-tax management and welfare and security.
					</p>
				</div>

				<div class='step' data-step='40' style='margin-bottom: 25%;'>
					<p>Development trend<br>
					1. From the management to services: On 8 Augus t 2003, the State Council promulgated the revised Regulations on Marriage Registration and successfully transitioned from marriage-registration management to service。
					</p>
				</div>

				<div class='step' data-step='41' style='margin-bottom: 25%;'>
					<p>2. Refined registration service for marriage: Since 2004, the service began keeping diversified records, including annual statistics of registration of marriage and divorce involving Chinese and foreign nationals, the age structure and distribution of registrants, changes in the ratio of marriage.
					</p>
				</div>

				<div id='titlef13' class='step' data-step='42'>
					<p>3. More diversified and immersed: The Adoption Law of the P.R. C(1992) Law of Succession(1985,2015), Regulation on the Administration of Medical Institutions(1994,) Administrative Provisions on Religious Activities of Foreigner Nationals(1990) stipulated the administrative measures for foreigners concerning adoption, inheritance, religious activities or the setting up of medical institutions in China.
					</p>
				</div>

				<div class='step' data-step='43' style='margin-bottom: 25%;'>
					<p>自1986年至2013年，我国结婚登记数整体呈现增加趋势，2013年达到1341.4万对，此后，结婚登记数逐年下降。
					</p>
				</div>

				<div class='step' data-step='44' style='margin-bottom: 25%;'>
					<p>2003年起，我国涉外婚姻登记人数整体呈下降趋势，其中2009年至2013年，涉外婚姻登记人数有所增加，但仍未超过2003年时的7.8万对。
					</p>
				</div>

				<div class='step' data-step='45' style='margin-bottom: 25%;'>
					<p>2003年起，涉外婚姻在全国结婚登记总人数中所占比例整体呈下降趋势，2015年至今逐渐增大，但总体而言，涉外婚姻在全国结婚登记数中占比尚未超过1%。
					</p>
				</div>

				<div id='titlef14' class='step' data-step='46'>
					<p style="background: url(./img/title.png);background-size:100% 100%;font-weight:bold;text-align: center;margin: 5% 20%">Cultural exchange</p>
				</div>

				<div class='step' data-step='47'>
					<p>Cultural exchange has gone from being expansive to being intensive before joining politics and economy as the three major pillars. It is comprised of education, culture, health, sport and entertainment. 
					</p>
				</div>

				<div id='titlef15' class='step' data-step='48'>
					<p style="font-weight: bold">Let us take a look at the key stages of development the management and service policies on cultural exchange for foreigners in China have undergone in 70 years:
					</p>
				</div>

				<div class='step' data-step='49' style='margin-bottom: 25%;'>
					<p>Cultural exchange as a unique and guiding channel (1949 – 1978)
					</p>
				</div>

				<div class='step' data-step='50' style='margin-bottom: 25%;'>
					<p>New stage in the Chinese reform (1978 – 2012)
					</p>
				</div>

				<div id='titlef16' class='step' data-step='51'>
					<p style="font-weight: bold">2010年至2018年中国引进版权的总数基本持平，其中美国、英国、日本是我国主要的版权引进国。美国是中国版权引进第一大国，但这十年间从美国引进的版权总数有所下降，相反的是，从英国和日本引进版权的数量都有所上升。
					</p>
				</div>

				<div class='step' data-step='52'>
					<p style="font-weight: bold">在图书、期刊、报纸国际贸易的种数、数量和金额三个方面，都是进口大于出口。
					</p>
				</div>

				<div id='titlef17' class='step' data-step='53'>
					<p style="font-weight: bold">2018年的数据告诉我们，这些产品进口金额达到了出口金额的6倍之多。此外，图书一直扮演着进出口舞台上举足轻重的角色。
					</p>
				</div>

				<div class='step' data-step='54'>
					<p style="background: url(./img/title.png);background-size:100% 100%;font-weight:bold;text-align: center;margin: 5% 15%">Reward and Punishment</p>
				</div>

				<div id='titlef18' class='step' data-step='55'>
					<p style="font-weight: bold">中国政府友谊奖，是中国政府为表彰在中国现代化建设和改革开放事业中作出突出贡献的外国专家而设立的最高奖项，由国务院授权国家外国专家局于1991年正式设立。“友谊奖”每年约产生50名获奖者，国庆逢五逢十则将评选约百名。迄今为止，共有1,500名个人获得了“友谊奖”
					</p>
				</div>

			</article>




		</section>

	</main>

	<!-- <div class='debug'></div> -->
	<script src='https://unpkg.com/d3@5.9.1/dist/d3.min.js'></script>
	<script src='https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js'></script>
	<script src='./stickyfill.min.js'></script>
	<script src='./scrollama.min.js'></script>
	<script>
		// using d3 for convenience
		var main = d3.select('main')
		var scrolly = main.select('#scrolly');
		var figure = scrolly.select('figure');
		var article = scrolly.select('article');
		var step = article.selectAll('.step');
		var dic = [0,1,2,3,3,3,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,8,8,9,10,11,12,13,14,16,16,16,17,17,18,18,18,18,18,18,18,18,19,19,20,20,20,21,22,23,24,25]
		/*2,2,2,2,2,2,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,11,11,11]*/
		/*var margin = new Array()
		margin[43] = '10%'
		margin.push('445','445','445','445','445','445','445','445','445','445')
		*/
		var z = new Array()
		z[13] = 999
		z.push(999,999,999,999,999)
		/*
		dic[0] = 0
		dic[1] = 1
		dic[2] = 1
		dic[3] = 2
		dic[3] = 2
		dic[3] = 2
		dic[3] = 2
		dic[3] = 2
		dic[3] = 2
		dic[3] = 2
		dic[10] = 3
		dic[11] = 4
		dic[18] = 5
		dic[25] = 6
		dic[31] = 7
		*/
		titlef.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef2.style='margin:'+window.innerHeight*0.5+ 'px auto '+window.innerHeight*0.5+'px auto';
		titlef3.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef4.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef5.style='margin:'+window.innerHeight*0.5+ 'px auto 25% auto';
		titlef6.style='margin:'+window.innerHeight*0.5+ 'px auto '+window.innerHeight*0.5+'px auto';
		titlef7.style='margin:'+window.innerHeight*0.5+ 'px auto '+window.innerHeight*0.5+'px auto';
		titlef8.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef9.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef10.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef11.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef12.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef13.style='margin: 25% auto '+window.innerHeight+'px auto';
		titlef14.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef15.style='margin:'+window.innerHeight+ 'px auto 25% auto';
		titlef16.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef17.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';
		titlef18.style='margin:'+window.innerHeight+ 'px auto '+window.innerHeight+'px auto';

		// initialize the scrollama
		var scroller = scrollama();
		// generic window resize listener event
		function handleResize() {
			// 1. update height of step elements
			var stepH = Math.floor(window.innerHeight*1.2);
			var stepW = Math.floor(window.width);
			//step.style('height', stepH + 'px');
			//step.style('weight', stepW + 'px');

			var figureHeight = window.innerHeight // 2
			var figureMarginTop = (window.innerHeight - figureHeight) // 2

			figure
				.style('height',  figureHeight + 'px')
				.style('top', figureMarginTop + 'px');

			// 3. tell scrollama to update new element dimensions
			scroller.resize();
		}

		// scrollama event handlers
		function handleStepEnter(response) {
			console.log(response)
			// response = { element, direction, index }

			// add color to current step only
			step.classed('is-active', function (d, i) {
				return i === response.index;
			})

			// update graphic based on step
			//figure.select('p').text(response.index + 1);
			CGTN.src = "./CGTN/CGTN.html#slide-"+String(dic[response.index]);
			//CGTN.style = 'top:'+String(margin[response.index]);
			ninelines.style = 'z-index:'+String(z[response.index]);
			

		}

		function setupStickyfill() {
			d3.selectAll('.sticky').each(function () {
				Stickyfill.add(this);
			});
		}

		function init() {
			setupStickyfill();

			// 1. force a resize on load to ensure proper dimensions are sent to scrollama
			handleResize();

			// 2. setup the scroller passing options
			// 		this will also initialize trigger observations
			// 3. bind scrollama event handlers (this can be chained like below)
			scroller.setup({
				step: '#scrolly article .step',
				offset: 0.7,
				debug: false,
			})
				.onStepEnter(handleStepEnter)


			// setup resize event
			window.addEventListener('resize', handleResize);
		}

		// kick things off
		init();
	</script>
</body>

</html>